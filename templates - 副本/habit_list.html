{% extends 'base.html' %} {% from 'macros.html' import form_field %} {% block content %}

<div class="tab-content">
    <div class="row content-list-head card-list-head">
        <div class="col-auto">
            <h3>Habits </h3>
            <button class="btn btn-round" data-toggle="modal" data-target="" id='add-new-habit-btn'>
                    <i class="icon-plus"></i>
                </button> </div>
    </div>
    <div class="tab-pane fade show active" id="tasks" role="tabpanel" data-filter-list="card-list-body">
        {% for category in categorys%}
        <div class="card-list ">
            <div class="row content-list-head card-list-head">
                <div class="col-auto">
                    <h6> {{category.category}} </h6>
                </div>
            </div>
            <div class="card-list-body">
                {% for habit in category.habits %} {% set progress = habit.done_on_month * 100 / 31 %} {% set progress_bg = "bg-danger" %} {% if progress>30 %} {% set progress_bg='bg-success' %} {% endif %}

                <div class="card card-task">
                    <div class="progress">
                        <div class="progress-bar {{progress_bg}}" role="progressbar" style="width: {{progress}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <div class="card-body">
                        <div class="card-title">
                            <a href="https://pipeline.mediumra.re/nav-side-project.html#">
                                <h6 data-filter-by="text" class="H6-filter-by-text">{{ habit.name }}</h6>
                            </a>
                            <span class="text-small">Today</span>
                        </div>
                        <div class="card-meta">
                            <div class="d-flex align-items-center">
                                <i class=" icon-list-alt "></i>
                                <span>3/4</span>
                            </div>
                            <div class="dropdown card-options">
                                <button class="btn-options" type="button" id="task-dropdown-button-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class=" icon-reorder "></i>
                        </button>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="https://pipeline.mediumra.re/nav-side-project.html#"> Edit</a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item text-danger" href="https://pipeline.mediumra.re/nav-side-project.html#"> Delete</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modal title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
                </div>
                <div class="modal-body">
                    <p>Modal body text goes here.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(function() {
            $('#add-new-habit-btn').click(function() {
                $.ajax({
                    url: '/new_habit', // 目标URL
                    type: 'GET', // 请求方法
                    success: function(data) { // 返回2XX响应后触发的回调函数
                        console.log('success')
                        $('#myModalContent').html(data)
                        $('#myModal').modal('show')
                    }
                })
            })
        })
    </script>
</div>
{% endblock %}